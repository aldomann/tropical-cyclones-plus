---
title: "Análisis de las marginales"
author: "Alfredo Hernández"
output:
  html_notebook:
    toc: yes
    toc_depth: 3
  html_document:
    df_print: paged
  pdf_document:
    fig_height: 3.5
    toc: yes
    toc_depth: 2
---

```{r message=FALSE, warning=FALSE, include=FALSE}
# Libraries ------------------------------------------------
library(measurements) # Convert units

# Source base code -----------------------------------------
source("marginals_base.R")
```

```{r}
# Get RAW data ---------------------------------------------
pdi.all <- as_tibble(data.table::fread('data/hurdat2-hadisst-1966-2016_pdis.csv')) %>%
	mutate(storm.duration = conv_unit(storm.duration, "sec", "hr"))

pdi.natl <- pdi.all %>%
	dplyr::filter(basin == "NATL")
pdi.epac <- pdi.all %>%
	dplyr::filter(basin == "EPAC")
```

# Clean data
```{r}
natl.data <- pdi.natl %>% 
	# dplyr::filter(sst.class == "high") %>%
	dplyr::filter(max.wind > 33) %>% 
	select(storm.pdi, storm.duration, max.wind, sst.class)
```

## Compare
```{r}
ggplot(natl.data) +
	aes(x = log10(storm.pdi), colour = sst.class) +
	geom_density()
```

```{r}
ggplot(natl.data) +
	aes(x = log10(storm.duration), colour = sst.class) +
	geom_density()
```

```{r}
summarise_marginals_stats("NATL")
summarise_marginals_stats("EPAC")
summarise_marginals_stats("NATL", 33)
summarise_marginals_stats("EPAC", 33)
```

```{r}
analyse_marginals_compat("NATL")
analyse_marginals_compat("EPAC")
analyse_marginals_compat("NATL", 33)
analyse_marginals_compat("EPAC", 33)
```


