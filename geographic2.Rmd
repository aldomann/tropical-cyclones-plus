---
title: "Análisis de la posición y distancia recorrida de los huracanes"
author: "Alfredo Hernández"
output:
  pdf_document: 
    fig_height: 3.5
    toc: yes
    toc_depth: 2
  html_document:
    df_print: paged
  html_notebook: default
---

```{r message=FALSE, warning=FALSE, include=FALSE}
# Libraries ------------------------------------------------
library(measurements) # Convert units

# Source base code -----------------------------------------
source("geographic_base.R")
load("geographic_analysis.RData")
source("../libs/multiplot.R")
```

\newpage
# Análisis de la distancia (II)

```{r include=FALSE}
storms.tracks <- storms.all %>%
	group_by(storm.id) %>%
	mutate(distance = haversine_distance(lat, lag(lat), long, lag(long))) %>%
	mutate(distance = ifelse(is.na(distance), 0, distance)) %>%
	summarise(first.lat = first(lat), last.lat = last(lat),
						first.long = first(long), last.long = last(long),
						distance = sum(distance))
```

## Mínimos y máximos de distancia recorrida y duración

### Distancias
```{r}
# Summary of the distances
storms.joint %>%
	group_by(basin, sst.class) %>%
	summarise(dist.mean = round(mean(distance)/1000))
```

### Duraciones
```{r}
# Summary of the durations
storms.joint %>%
	group_by(basin, sst.class) %>%
	summarise(dist.mean = round(mean(storm.duration)))
```



<!-- \newpage -->
# Análisis de posición inicial y final (II)

En los gráficos (no he puesto el continente de fondo) tenemos básicamente un scatterplot de la posición inicial y final (separado por años calientes y fríos), además he hecho que la transparencia de los puntos así como el tamaño dependan de la distancia recorrida por los huracanes.

\newpage
## North Atlantic

### Todas las tormentas (NATL)
```{r}
plot_positions_histogram("NATL", "first") + theme_bw()
plot_positions_histogram("NATL", "last") + theme_bw()
```

### Developing systems (NATL)
```{r}
plot_positions_histogram("NATL", "first", 33) + theme_bw()
plot_positions_histogram("NATL", "last", 33) + theme_bw()
```

\newpage
## East Pacific

### Todas las tormentas (EPAC)
```{r}
plot_positions_histogram("EPAC", "first") + theme_bw()
plot_positions_histogram("EPAC", "last") + theme_bw()
```

### Developing systems (EPAC)
```{r}
plot_positions_histogram("EPAC", "first", 33) + theme_bw()
plot_positions_histogram("EPAC", "last", 33) + theme_bw()
```


\newpage
## Mirando las medias

### Todas las tormentas
```{r}
get_stat_summary("NATL")
get_stat_summary("EPAC")
```

### Developing systems
```{r}
get_stat_summary("NATL", 33)
get_stat_summary("EPAC", 33)
```

